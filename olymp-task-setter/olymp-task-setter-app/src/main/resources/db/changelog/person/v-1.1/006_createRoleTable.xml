<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog 
                   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">

    <changeSet id="createRoleTable" author="liman">
        <createTable tableName="roles" schemaName="person">
            <column name="id" type="${uuid_type}">
                <constraints primaryKey="true"/>
            </column>
            <column name="person_id" type="${uuid_type}">
                <constraints referencedTableName="base_persons"
                             referencedTableSchemaName="person"
                             referencedColumnNames="id"
                             foreignKeyName="fk__role_id__person_id"
                             nullable="false"/>
            </column>
            <column name="olympiad_id" type="${uuid_type}">
                <constraints referencedTableName="olympiads"
                             referencedTableSchemaName="olympiad"
                             referencedColumnNames="id"
                             foreignKeyName="fk__participant_id__olympiad_id"
                             nullable="false"/>
            </column>
            <column name="role_name" type="${text_type}">
                <constraints nullable="false"/>
            </column>
            <column name="created_at"
                    type="${datatype.date.timestamptz}"
                    defaultValueComputed="${datatype.date.currentTimestamp}"/>
            <column name="modified_at"
                    type="${datatype.date.timestamptz}"
                    defaultValueComputed="${datatype.date.currentTimestamp}"/>
        </createTable>

        <addUniqueConstraint
                schemaName="person"
                tableName="roles"
                columnNames="olympiad_id, role_name"
                constraintName="uq__olympiad_id__role_name"/>
    </changeSet>
</databaseChangeLog>